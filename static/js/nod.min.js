(function(){var e,t,n,r=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e,t){this.$el=e;this.createGetValue=r(this.createGetValue,this);this.runCheck=r(this.runCheck,this);this.delayedCheck=r(this.delayedCheck,this);this.events=r(this.events,this);this.checker=t[0],this.delay=t[1];this.delayId="";this.getVal=this.createGetValue(this.$el);this.events()}e.prototype.events=function(){this.$el.on("keyup",this.delayedCheck);this.$el.on("blur",this.runCheck);return this.$el.on("change",this.runCheck)};e.prototype.delayedCheck=function(){clearTimeout(this.delayId);return this.delayId=setTimeout(this.runCheck,this.delay)};e.prototype.runCheck=function(){var e;e=this.checker(this.getVal());if(this.$el.status!==e){this.$el.status=e;return this.$el.trigger("toggle")}};e.prototype.createGetValue=function(e){if(e.attr("type")==="checkbox"){return function(){return e.is(":checked")}}else{return function(){return $.trim(e.val())}}};return e}();(function(e){return e.fn.nod=function(e,n){new t(this,e,n);return this}})(jQuery);t=function(){function t(e,t,n){this.form=e;this.fields=t;this.createEls=r(this.createEls,this);this.toggleSubmitBtn=r(this.toggleSubmitBtn,this);this.toggleGroupClass=r(this.toggleGroupClass,this);this.toggle=r(this.toggle,this);this.massCheck=r(this.massCheck,this);this.events=r(this.events,this);this.get=$.extend({delay:700,disableSubmitBtn:true,helpSpanDisplay:"help-inline",groupClass:"error",submitBtnSelector:"[type=submit]",metricsSplitter:":",errorPosClasses:[".help-inline",".add-on","button",".input-append"],broadcastError:false,errorClass:"nod_msg",groupSelector:".control-group"},n);this.err=["Arguments for each field must have three parts: ","Couldn't find any form: ","Couldn't find any Submit button: ","The selector in 'same-as' isn't working","I don't know "];if(!this.fields){return}this.els=this.createEls();this.submit=this.form.find(this.get.submitBtnSelector);this.checkIfElementsExist(this.form,this.submit,this.disableSubmitBtn);this.events()}t.prototype.checkIfElementsExist=function(e,t,n){if(!e.selector||!e.length){throw this.err[1]+e}if(!t.length&&n){throw this.err[2]+t}};t.prototype.events=function(){var e,t,n,r,i;this.submit.on("click",this.massCheck);r=this.els;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e.on("toggle",this.toggle))}return i};t.prototype.massCheck=function(e){var t,n,r,i,s;i=this.els;s=[];for(n=0,r=i.length;n<r;n++){t=i[n];t.trigger("change");if(!t.status){s.push(e.preventDefault())}else{s.push(void 0)}}return s};t.prototype.toggle=function(e){this.toggleGroupClass($(e.currentTarget));if(this.get.disableSubmitBtn){return this.toggleSubmitBtn()}};t.prototype.toggleGroupClass=function(e){var t,n;t=e.parents(this.get.groupSelector);n=t.find("."+this.get.errorClass);if(n.length){return t.addClass(this.get.groupClass)}else{return t.removeClass(this.get.groupClass)}};t.prototype.toggleSubmitBtn=function(){var e,t,n,r,i,s;t="disabled";this.submit.removeClass(t).removeAttr(t);i=this.els;s=[];for(n=0,r=i.length;n<r;n++){e=i[n];if(!e.status){s.push(this.submit.addClass(t).attr(t,t))}else{s.push(void 0)}}return s};t.prototype.createEls=function(){var t,r,i,s,o,u,a,f,l,c,h,p;i=[];h=this.fields;for(a=0,l=h.length;a<l;a++){s=h[a];if(s.length!==3){throw this.err[0]+s}u=[s[2],this.get.helpSpanDisplay,this.get.errorClass,this.get.errorPosClasses,this.get.broadcastError];o=[this.makeChecker(s[1]),this.get.delay];p=$(s[0]);for(f=0,c=p.length;f<c;f++){r=p[f];t=$(r);i.push(t);new n(t,u);new e(t,o)}}return i};t.prototype.makeChecker=function(e){var t,n,r,i;if(!!(e&&e.constructor&&e.call&&e.apply)){return function(t){return e(t)}}if(e instanceof RegExp){return function(t){return e.test(t)}}i=$.map(e.split(this.get.metricsSplitter),$.trim),r=i[0],t=i[1],n=i[2];if(r==="same-as"&&$(t).length!==1){throw new Error(this.err[3])}switch(r){case"presence":return function(e){return!!e};case"exact":return function(e){return e===t};case"not":return function(e){return e!==t};case"same-as":return function(e){return e===$(t).val()};case"min-length":return function(e){return e.length>=t};case"max-length":return function(e){return e.length<=t};case"exact-length":return function(e){return e.length===t};case"between":return function(e){return e.length>=t&&e.length<=n};case"integer":return function(e){return!e||/^\s*\d+\s*$/.test(e)};case"float":return function(e){return!e||/^[-+]?[0-9]+(\.[0-9]+)?$/.test(e)};case"email":return function(e){return!e||/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/.test(e)};default:throw this.err[4]+r}};return t}();n=function(){function e(e,t){var n;this.$el=e;this.createShowMsg=r(this.createShowMsg,this);this.toggle=r(this.toggle,this);this.events=r(this.events,this);n={};n.msg=t[0],n.display=t[1],n.cls=t[2],this.pos_classes=t[3],this.broadcastError=t[4];this.$msg=this.createMsg(n);this.showMsg=this.createShowMsg();this.events()}e.prototype.events=function(){return this.$el.on("toggle",this.toggle)};e.prototype.createMsg=function(e){return $("<span/>",{html:e.msg,"class":e.display+" "+e.cls})};e.prototype.toggle=function(){if(this.$el.status){return this.$msg.remove()}else{this.showMsg();if(this.broadcastError){return this.broadcast()}}};e.prototype.createShowMsg=function(){var e;if(this.$el.attr("type")==="checkbox"){return function(){return this.$el.parent().append(this.$msg)}}else{e=this.findPos(this.$el);return function(){return e.after(this.$msg)}}};e.prototype.findPos=function(e){if(this.elHasClass("parent",e)){return this.findPos(e.parent())}if(this.elHasClass("next",e)){return this.findPos(e.next())}return e};e.prototype.elHasClass=function(e,t){var n,r,i,s;s=this.pos_classes;for(r=0,i=s.length;r<i;r++){n=s[r];if(t[e](n).length){return true}}return false};e.prototype.broadcast=function(){var e;e={el:this.$el,msg:this.$msg.html()};return $(window).trigger("nod_error_fired",e)};return e}()}).call(this)